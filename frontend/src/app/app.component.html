<div class="app-container">

  <div class="sidebar" [class.sidebar-open]="showAdmin">
    <div class="sidebar-header">
      <h2>üõ°Ô∏è FLEET COMMAND</h2>
      <button class="btn-close" (click)="toggleAdmin()">√ó</button>
    </div>

    <div class="sidebar-content">
      <div class="panel-section deploy-section">
        <h3>Deploy New Unit</h3>
        <div class="form-grid">
          <div class="input-group">
            <label>Call Sign</label>
            <input [(ngModel)]="newDrone.callSign" placeholder="e.g. Raptor-X">
          </div>
          <div class="input-group">
            <label>Model Type</label>
            <input [(ngModel)]="newDrone.model" placeholder="e.g. MQ-9 Reaper">
          </div>
        </div>
        <button (click)="addDrone()" class="btn-deploy" [disabled]="!newDrone.callSign || !newDrone.model">
          DEPLOY UNIT
        </button>
      </div>

      <div class="panel-section list-section">
        <h3>Active Units List ({{dbDrones.length}})</h3>

        <div class="drone-list">
          <div *ngIf="dbDrones.length === 0" class="loading-state">
            Searching database... <br> <small>(If stuck, check CORS/Backend)</small>
          </div>

          <div class="drone-card" *ngFor="let d of dbDrones">
            <div class="drone-info">
              <span class="drone-callsign">{{ d.callSign }}</span>
              <span class="drone-model">{{ d.model }}</span>
              <div class="status-row">
                <span class="drone-status" [ngClass]="d.status?.toLowerCase()">
                  {{ d.status || 'OFFLINE' }}
                </span>
                <button (click)="toggleSimulation(d)" class="btn-sim" [class.active]="isSimulating(d.id)"
                  [title]="isSimulating(d.id) ? 'Stop Patrol' : 'Start Auto-Patrol'">
                  {{ isSimulating(d.id) ? '‚èπ' : '‚ñ∂' }}
                </button>
              </div>
            </div>
            <button (click)="decommission(d.id)" class="btn-decommission" title="Decommission">
              üóëÔ∏è
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="main-content">
    <div class="hud-overlay">
      <h1>SENTINEL GRID <span class="blink">LIVE</span></h1>
      <button (click)="toggleAdmin()" class="btn-hud-toggle">
        ‚öôÔ∏è MANAGE FLEET
      </button>
    </div>

    <div id="map"></div>
  </div>

</div>